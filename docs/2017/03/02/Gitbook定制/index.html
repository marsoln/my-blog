<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Marsoln 修行札记">
    

    <!--Author-->
    
        <meta name="author" content="Marsoln">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Gitbook定制"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Marsoln 修行札记" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="marsoln&#39;s blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Gitbook定制 - marsoln&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/my-blog/css/style.css">

</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/my-blog/">
                    首页
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/my-blog/archives">
                    归档
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/my-blog/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/my-blog/2017/03/02/Gitbook定制/">
                Gitbook定制
            </a>
        </h1>
        <div class="post-info">
            <span class="date">2017-03-02</span>
            <a href="#disqus_thread" class="comments">留言</a>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h1 id="Gitbook-website-主题定制化"><a href="#Gitbook-website-主题定制化" class="headerlink" title="Gitbook website 主题定制化"></a>Gitbook website 主题定制化</h1><h2 id="Gitbook的文档组织结构的定制"><a href="#Gitbook的文档组织结构的定制" class="headerlink" title="Gitbook的文档组织结构的定制"></a>Gitbook的文档组织结构的定制</h2><p>在文档源文件根目录里的 <code>SUMMARY.md</code> 作为目录结构的载体,生成左侧的book_summary块,模板会遍历Summary中定义的parts,对于每个part里的articles通过一个递归方法去生成菜单.想要针对菜单不同层级做定制式的处理,可以从此处入手修改.</p>
<blockquote>
<p>如果只是需要做css定制而不希望改变DOM结构的话,可以借助菜单节点的 <code>data-level</code> 属性去实现.</p>
</blockquote>
<p>以default-theme为例<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">&#123;% for part in summary.parts %&#125;</div><div class="line">    &#123;% if part.title %&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>&#123;&#123; part.title &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    &#123;% elif not loop.first %&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    &#123;% endif %&#125;</div><div class="line">    &#123;&#123; articles(part.articles, file, config) &#125;&#125;</div><div class="line">&#123;% endfor %&#125;</div><div class="line"></div><div class="line">&#123;% macro articles(_articles) %&#125;</div><div class="line">    &#123;% for article in _articles %&#125;</div><div class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"chapter &#123;% if article.path == file.path and not article.anchor %&#125;active&#123;% endif %&#125;"</span> <span class="attr">data-level</span>=<span class="string">"&#123;&#123; article.level &#125;&#125;"</span> &#123;% <span class="attr">if</span> <span class="attr">article.path</span> %&#125;<span class="attr">data-path</span>=<span class="string">"&#123;&#123; article.path|resolveFile &#125;&#125;"</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span></div><div class="line">            &#123;% if article.path and getPageByPath(article.path) %&#125;</div><div class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; article.path|resolveFile &#125;&#125;&#123;&#123; article.anchor &#125;&#125;"</span>&gt;</span></div><div class="line">            &#123;% elif article.url %&#125;</div><div class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; article.url &#125;&#125;"</span>&gt;</span></div><div class="line">            &#123;% else %&#125;</div><div class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span></div><div class="line">            &#123;% endif %&#125;</div><div class="line">                    &#123;% if article.level != "0" and config.pluginsConfig['theme-default'].showLevel %&#125;</div><div class="line">                        <span class="tag">&lt;<span class="name">b</span>&gt;</span>&#123;&#123; article.level &#125;&#125;.<span class="tag">&lt;/<span class="name">b</span>&gt;</span></div><div class="line">                    &#123;% endif %&#125;</div><div class="line">                    &#123;&#123; article.title &#125;&#125;</div><div class="line">            &#123;% if article.path  or article.url %&#125;</div><div class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            &#123;% else %&#125;</div><div class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            &#123;% endif %&#125;</div><div class="line"></div><div class="line">            &#123;% if article.articles.length &gt; 0 %&#125;</div><div class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"articles"</span>&gt;</span></div><div class="line">                &#123;&#123; articles(article.articles, file, config) &#125;&#125;</div><div class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">            &#123;% endif %&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    &#123;% endfor %&#125;</div><div class="line">&#123;% endmacro %&#125;</div></pre></td></tr></table></figure></p>
<h2 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a>自定义样式</h2><p>Gitbook默认的Theme提供了style自定义的功能.</p>
<p>其配置定义如下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="string">"gitbook"</span>: &#123;</div><div class="line">    <span class="string">"properties"</span>: &#123;</div><div class="line">      <span class="string">"styles"</span>: &#123;</div><div class="line">        <span class="string">"type"</span>: <span class="string">"object"</span>,</div><div class="line">        <span class="string">"title"</span>: <span class="string">"Custom Stylesheets"</span>,</div><div class="line">        <span class="string">"properties"</span>: &#123;</div><div class="line">          <span class="string">"website"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet for website output"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/website.css"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"pdf"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet for PDF output"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/pdf.css"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"epub"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet for ePub output"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/epub.css"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"mobi"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet for Mobi output"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/mobi.css"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"ebook"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet for ebook outputs (PDF, ePub, Mobi)"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/ebook.css"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"print"</span>: &#123;</div><div class="line">            <span class="string">"title"</span>: <span class="string">"Stylesheet to replace default ebook css"</span>,</div><div class="line">            <span class="string">"default"</span>: <span class="string">"styles/print.css"</span></div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      <span class="string">"showLevel"</span>: &#123;</div><div class="line">        <span class="string">"type"</span>: <span class="string">"boolean"</span>,</div><div class="line">        <span class="string">"title"</span>: <span class="string">"Show level indicator in TOC"</span>,</div><div class="line">        <span class="string">"default"</span>: <span class="literal">false</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>可以在自己项目中的book.json中做自定义配置,譬如我希望使用项目根目录名为 <code>websiteStyle.css</code> 的样式文件覆盖默认主题在生成website时的部分样式,就可以:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "styles":&#123;</div><div class="line">        "website":"./websiteStyle.css"</div><div class="line">    &#125;,</div><div class="line">    // ---忽略下面的部分---</div><div class="line">    "plugins": [</div><div class="line">        "-sharing",</div><div class="line">        "-fontsettings",</div><div class="line">        "-search",</div><div class="line">        "-lunr"</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如此一来,我们在此配置的css就会作为站点样式在默认的样式之后加载.可以覆盖默认的css样式以达到自定义的目的.</p>
<h2 id="插件的形式定制新的Theme主题"><a href="#插件的形式定制新的Theme主题" class="headerlink" title="插件的形式定制新的Theme主题"></a>插件的形式定制新的Theme主题</h2><blockquote>
<p>下面示例使用github repo的形式创建一个gitbook的插件</p>
</blockquote>
<ul>
<li>首先,我们需要创建一个新的repo,然后在其中<code>npm init</code>初始化<code>package.json</code>配置文件.</li>
</ul>
<p>注意该配置文件中必须在<code>engines</code>中指明<code>gitbook</code>的版本<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"engines": &#123;</div><div class="line">    "gitbook": "&gt;=3.2.2"</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果你想要自定义一些配置节点也可以在<code>package.json</code>中声明.<br>譬如,现在需要一个keywords的配置,是一个字符串值,用来指定页面渲染后的meta中的keywords,那么我们可以写作:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">   	"gitbook":&#123;</div><div class="line">	"properties":&#123;</div><div class="line">		"keywords":&#123;</div><div class="line">			"type":"string",</div><div class="line">			"default":"",</div><div class="line">			"description":"meta keywords config"</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>接下来在入口文件中可以使用插件机制提供的hook来获取指定的config:</li>
</ul>
<p>index.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">hooks</span>: &#123;</div><div class="line">        <span class="attr">config</span>: <span class="function"><span class="keyword">function</span>(<span class="params">config</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">`config hook~\nconfig.keywords has a value:<span class="subst">$&#123;config[<span class="string">'keywords'</span>]&#125;</span>`</span>)</div><div class="line">            <span class="keyword">return</span> config</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>现在将这个简单的插件push到github,然后就可以在gitbook项目中使用了.我们只需要在项目的<code>book.json</code>中添加如下配置:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"plugins":["name@git+https://github.com/username/repo-name.git"]</div></pre></td></tr></table></figure>
<p>接下来,在<code>book.json</code>当前目录<code>gitbook install</code>安装该插件<br>插件安装完成后 <code>gitbook serve</code>启动服务器就可以按到我们的插件已经正常运行了</p>
<h2 id="提高开发时的效率"><a href="#提高开发时的效率" class="headerlink" title="提高开发时的效率"></a>提高开发时的效率</h2><p>虽然,上面我们使用了gitbook自带的插件机制将自定义的部分作为一个单独的插件库.<br>但是实际上开发的时候还是会感觉非常麻烦.<br>比如我改动一些样式,就必须要打包上传到github,然后到gitbook的项目中更新插件引用,然后再在本地host查看效果.</p>
<p>这样的一套流程显然是不能够满足我们的开发需求的.<br>所以需要在 <code>plugin</code> 项目中用gulp创建一个开发时的 watch 任务,监视开发目录的文件变动,然后打包替换到 <code>gitbook</code> 项目里的 <code>_book(默认的host目录)/gitbook/</code> 目录.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>)</div><div class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>)</div><div class="line"><span class="keyword">var</span> postcss = <span class="built_in">require</span>(<span class="string">'gulp-postcss'</span>)</div><div class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)</div><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack-stream'</span>)</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>)</div><div class="line"><span class="keyword">var</span> cssMinify = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>)</div><div class="line"><span class="keyword">var</span> through = <span class="built_in">require</span>(<span class="string">'through2'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> PATHS = &#123;</div><div class="line">    <span class="attr">SASS</span>: [<span class="string">'./src/scss/style.scss'</span>], <span class="comment">// scss 入口文件</span></div><div class="line">    SASS_ALL: [<span class="string">'./src/scss/**/*'</span>],</div><div class="line">    <span class="attr">SCRIPTS</span>: [<span class="string">'./src/js/**/index.js'</span>],</div><div class="line">    <span class="attr">SCRIPTS_ALL</span>: [<span class="string">'./src/js/**/*'</span>],</div><div class="line">    <span class="attr">production</span>: <span class="string">'./_assets/website/'</span>,</div><div class="line">    <span class="attr">development</span>: <span class="string">'../pdoc/node_modules/gitbook-plugin-polex/_assets/website/'</span>,</div><div class="line">    <span class="attr">debug</span>: <span class="string">'../pdoc/_book/gitbook/'</span>, <span class="comment">// 只适用在开发调试过程中 不需要重新host gitbook</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> getPath = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> ret = PATHS[process.env.NODE_ENV]</div><div class="line">    <span class="keyword">return</span> ret</div><div class="line">&#125;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'compileSass'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">var</span> plugins = [autoprefixer(&#123;</div><div class="line">        <span class="attr">browsers</span>: [</div><div class="line">            <span class="string">"android 4"</span>,</div><div class="line">            <span class="string">"iOS 6"</span>,</div><div class="line">            <span class="string">"last 2 versions"</span></div><div class="line">        ]</div><div class="line">    &#125;)]</div><div class="line">    gulp.src(PATHS.SASS)</div><div class="line">        .pipe(sass().on(<span class="string">'error'</span>, sass.logError))</div><div class="line">        .pipe(postcss(plugins))</div><div class="line">        .pipe(cssMinify())</div><div class="line">        .pipe(gulp.dest(getPath()))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(<span class="string">'compileScript'</span>, () =&gt; &#123;</div><div class="line">    gulp.src(PATHS.SCRIPTS)</div><div class="line">        .pipe(through.obj(<span class="function"><span class="keyword">function</span>(<span class="params">file, enc, cb</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> __filename = file.path.split(<span class="string">'\\'</span>).reverse()[<span class="number">1</span>]</div><div class="line">            gulp.src(file.path)</div><div class="line">                .pipe(webpack(&#123;</div><div class="line">                    <span class="attr">output</span>: &#123;</div><div class="line">                        <span class="attr">filename</span>: __filename === <span class="string">'core'</span> ? <span class="string">'gitbook.js'</span> : <span class="string">'theme.js'</span></div><div class="line">                    &#125;,</div><div class="line">                    <span class="attr">module</span>: &#123;</div><div class="line">                        <span class="attr">loaders</span>: [&#123;</div><div class="line">                            <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">                            <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">                            <span class="attr">loader</span>: <span class="string">'babel'</span>,</div><div class="line">                            <span class="attr">query</span>: &#123;</div><div class="line">                                <span class="attr">presets</span>: [<span class="string">'es2015'</span>]</div><div class="line">                            &#125;</div><div class="line">                        &#125;]</div><div class="line">                    &#125;</div><div class="line">                &#125;))</div><div class="line">                .pipe(gulp.dest(getPath()))</div><div class="line">            cb()</div><div class="line">        &#125;))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(<span class="string">'build'</span>, [<span class="string">'compileSass'</span>, <span class="string">'compileScript'</span>])</div><div class="line"></div><div class="line">gulp.task(<span class="string">'watch'</span>, [<span class="string">'compileSass'</span>, <span class="string">'compileScript'</span>], () =&gt; &#123;</div><div class="line">    gulp.watch(PATHS.SASS_ALL, [<span class="string">'compileSass'</span>])</div><div class="line">    gulp.watch(PATHS.SCRIPTS_ALL, [<span class="string">'compileScript'</span>])</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>在 <code>src/</code> 目录创建一个 <code>build.dev.sh</code> 脚本来完成打包替换的过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#! /bin/bash</span></div><div class="line">ROOT=../pdoc/node_modules/gitbook-plugin-polex/</div><div class="line"></div><div class="line"><span class="comment"># Cleanup folder</span></div><div class="line">rm -rf <span class="variable">$&#123;ROOT&#125;</span>_assets</div><div class="line">rm -rf <span class="variable">$&#123;ROOT&#125;</span>_layouts</div><div class="line"></div><div class="line"><span class="comment"># Recreate folder</span></div><div class="line">mkdir -p <span class="variable">$&#123;ROOT&#125;</span>_assets/website/</div><div class="line"></div><div class="line"><span class="comment"># Copy layouts</span></div><div class="line">cp -R _layouts/ <span class="variable">$&#123;ROOT&#125;</span>_layouts</div><div class="line"></div><div class="line"><span class="comment"># Copy fonts</span></div><div class="line">mkdir -p <span class="variable">$&#123;ROOT&#125;</span>_assets/website/fonts</div><div class="line">cp -R node_modules/font-awesome/fonts/ <span class="variable">$&#123;ROOT&#125;</span>_assets/website/fonts/fontawesome/</div><div class="line"></div><div class="line"><span class="comment"># Packaged via Gulp</span></div><div class="line">cross-env NODE_ENV=development gulp build</div><div class="line"></div><div class="line"><span class="comment"># Copy images if they exist</span></div><div class="line">mkdir -p <span class="variable">$&#123;ROOT&#125;</span>_assets/website/images</div><div class="line">imgs=`du -k <span class="string">"src/images"</span> | cut <span class="_">-f</span> 1` </div><div class="line">zero=0</div><div class="line"><span class="keyword">if</span> [ <span class="variable">$imgs</span> <span class="_">-gt</span> <span class="variable">$zero</span> ]; <span class="keyword">then</span></div><div class="line">cp src/images/*.* <span class="variable">$&#123;ROOT&#125;</span>_assets/website/images/</div><div class="line"><span class="keyword">else</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"没有图片要复制."</span></div><div class="line"><span class="built_in">exit</span> 0</div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/my-blog/tags/Gitbook-定制/">#Gitbook 定制</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        


    </div>
    

</div>
        </section>

    </div>
</div>

</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>关于</h2>
                <p>
                    如果有问题欢迎提ISSUE
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>最近发布</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/my-blog/2017/03/02/Gitbook定制/">Gitbook定制</a>
            </li>
            
            <li>
                <a class="footer-post" href="/my-blog/2016/10/01/好玩的社区/">好玩的社区</a>
            </li>
            
            <li>
                <a class="footer-post" href="/my-blog/2016/09/28/踩过的坑/">踩过的坑</a>
            </li>
            
            <li>
                <a class="footer-post" href="/my-blog/2016/09/28/工具使用/">工具使用</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/marsoln/my-blog">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/marsoln1988">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:marsoln1988@gmail.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    Hexo & Alpha-Dust What A Magic! ❤ by Marsoln
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/my-blog/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>